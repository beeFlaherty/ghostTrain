<h2>Virtual experience</h2>

<div id="virtual_experience">
	<div id="ride_output">
	</div>
</div>

<script id="ride_template" type="x-template">
	<h3>{{ user.trainsettings.name }}</h3>

	<a-scene>
		<a-assets>
		</a-assets>

		<a-sky color="{{system.sky.colour}}"></a-sky>

		<gt-room
			v-for="room in user.rooms"
			v-bind:index="$index"
			v-bind:room="room"
		></gt-room>
	</a-scene>
</script>

<script id="room_template" type="x-template">
	<a-entity
		id="room_{{ index }}"
		position="0 0 {{ index * -1 * $root.system.room.height }}"
	>
		<gt-light v-bind:type="room.light"></gt-light>

		<a-plane
			rotation="-90 0 0"
			position="0 0 0"
			width="{{ $root.system.room.width }}"
			height="{{ $root.system.room.height }}"
			color="{{ $root.configurable.themes[room.theme].colour }}"
		></a-plane>

		<gt-scare
			v-for="scare in room.scares"
			v-bind:index="$index"
			v-bind:monster="scare.monster"
			v-bind:sound="scare.sound"
			v-bind:animation="scare.animation"
		></gt-scare>
	</a-entity>
</script>


<script id="scare_template" type="x-template">
	<a-entity
		v-if="monster !== 'none'"
		position="0 {{ $root.system.monster.height / 2 }} {{ getPosition(index) }}"
	>
		<a-box
			rotation="0 0 0"
			width="{{ $root.system.monster.width }}"
			height="{{ $root.system.monster.height }}"
			depth="0.1"
			color="{{ $root.configurable.monsters[monster].colour }}"
		>
			<a-animation
				v-if="animation === 'popup'"
				attribute="rotation"
				from="-90 0 0"
				to="0 0 0"
				dur="{{ $root.system.animation.duration }}"
				fill="both"
				easing="ease-out-bounce"
				repeat="{{ $root.system.animation.repeat }}"
			></a-animation>
			<a-animation
				v-if="animation === 'popup'"
				attribute="position"
				from="0 {{ $root.system.monster.height * -1 }} 0"
				to="0 0 0"
				dur="{{ $root.system.animation.duration }}"
				fill="both"
				easing="ease-out-bounce"
				repeat="{{ $root.system.animation.repeat }}"
			></a-animation>

			<a-animation
				v-if="animation === 'dropdown'"
				attribute="position"
				from="0 {{ $root.system.monster.height * 3 }} 0"
				to="0 0 0"
				dur="{{ $root.system.animation.duration }}"
				fill="both"
				easing="ease-out-bounce"
				repeat="{{ $root.system.animation.repeat }}"
			></a-animation>
			<a-animation
				v-if="animation === 'dropdown'"
				attribute="rotation"
				from="0 0 30"
				to="0 0 0"
				dur="{{ $root.system.animation.duration }}"
				fill="both"
				easing="ease-out-bounce"
				repeat="{{ $root.system.animation.repeat }}"
			></a-animation>

			<a-animation
				v-if="animation === 'fromleft'"
				attribute="rotation"
				from="0 90 0"
				to="0 0 0"
				dur="{{ $root.system.animation.duration }}"
				fill="both"
				easing="ease-out-bounce"
				repeat="{{ $root.system.animation.repeat }}"
			></a-animation>
			<a-animation
				v-if="animation === 'fromleft'"
				attribute="position"
				from="{{ $root.system.monster.width * -1 }} 0 0"
				to="0 0 0"
				dur="{{ $root.system.animation.duration }}"
				fill="both"
				easing="ease-out-bounce"
				repeat="{{ $root.system.animation.repeat }}"
			></a-animation>

			<a-animation
				v-if="animation === 'fromright'"
				attribute="rotation"
				from="0 -90 0"
				to="0 0 0"
				dur="{{ $root.system.animation.duration }}"
				fill="both"
				easing="ease-out-bounce"
				repeat="{{ $root.system.animation.repeat }}"
			></a-animation>
			<a-animation
				v-if="animation === 'fromright'"
				attribute="position"
				from="{{ $root.system.monster.width * 1 }} 0 0"
				to="0 0 0"
				dur="{{ $root.system.animation.duration }}"
				fill="both"
				easing="ease-out-bounce"
				repeat="{{ $root.system.animation.repeat }}"
			></a-animation>
		</a-box>
	</a-entity>
</script>

<script id="light_template" type="x-template">
	<a-light
		v-if="type !== 'dark'"
		type="point"
		intensity="0.75"
		distance="15"
		decay="2"
		position="0 3 0"
	>
		<a-animation
			v-if="type === 'flickering'"
			attribute="intensity"
			dur="300"
			fill="forwards"
			from="1"
			to="0"
			direction="alternate"
			repeat="indefinite"></a-animation>
		<a-animation
			v-if="type === 'glowing'"
			attribute="intensity"
			dur="1000"
			fill="forwards"
			from="1"
			to="0"
			direction="alternate"
			easing="ease"
			repeat="indefinite"></a-animation>
	</a-light>
</script>
